<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="We describe the sources of our data and the cleaning process.">

<title>Team 8 Final Project - Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Team 8 Final Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./big_picture.html" rel="" target="">
 <span class="menu-text">Big Picture</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./analysis.html" rel="" target="">
 <span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./data.html" rel="" target="" aria-current="page">
 <span class="menu-text">Data</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-page" id="toc-data-page" class="nav-link active" data-scroll-target="#data-page"><strong>Data Page</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data</h1>
</div>

<div>
  <div class="description">
    We describe the sources of our data and the cleaning process.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="data-page" class="level1">
<h1><strong>Data Page</strong></h1>
<p><img src="images/crt-resources-sm-02.jpg" class="img-fluid"></p>
<p>This page serves as a gateway of the sources of our data and the cleaning process. To understand racial education division, we gathered three datasets, capturing variables like educational attainment, income levels, and poverty status across different demographics in the United States. Our data sources include the American Community Survey (ACS) and the U.S. Department of Labor (DOL).</p>
<p><strong>Data set 1: American Community Survey (ACS) - Educational Attainment</strong></p>
<p>Finding data on the educational attainment and income of women was relatively easy, but specifically searching for those data faceted by a woman’s race was challenging.</p>
<p>Data set 1 is our <em>main dataset</em>. It is named “Educational Attainment” and sourced from the American Community Survey (ACS) produced by the United States Census Bureau which provides data from 2010-2022 regarding educational attainment of males and females, faceted to race and state. This data set also provides general information on the poverty rate for ages 25 by educational attainment and the inflation-adjusted yearly median earnings by educational attainment - although these additional data are not faceted by race and can only help as background/general information. The link to the ACS dataset is <a href="https://bit.ly/49WpvK9" class="uri">https://bit.ly/49WpvK9</a>.</p>
<p>The ACS is specifically designed to assess various demographic, social, and economic conditions across the U.S. It helps measure the changes in the community over time. Gathering this data annually allows for the effective monitoring of trends and the ability to react to shifts in educational attainment, poverty rates, and other important socioeconomic factors. This survey plays a crucial role in public administration by guiding the allocation of federal and state funds, planning educational programs, and developing social services tailored to the needs of diverse populations.</p>
<p>The variables of dataset 1 include time in years, race, educational attainment, region, and gender. The time variable ranges from 2010 to 2022. The race variable consists of 9 categories: ‘White Alone’, ‘White Alone - not Hispanic or Latino’, ‘Black Alone’, ‘American Indian or Alaska Native Alone’, ‘Asian Alone’, ‘Native Hawaiian and Other Pacific Islander Alone’, ‘Some other race alone’, ‘Two or more races’, and ‘Hispanic or Latino Origin’. Educational attainment is broken down by ‘High school graduate or higher’ and ‘Bachelor’s degree or higher’, and is shown as a percentage of male and female through the gender variable. The regional variable contains the 50 states of the United States and Puerto Rico.</p>
<p>To clean dataset 1, we followed the following steps:</p>
<p><em>1. Initial Data Reading and Package Loading</em></p>
<p>We begin by suppressing messages to keep our output clean while loading necessary libraries (‘readxl’ and ‘tidyverse’). This ensures that only essential output is displayed, making our script more readable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(readxl))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>acs_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'dataset/ACS_data_rendered.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>2. Standardizing Reference Arrays</em></p>
<p>We define arrays for ‘state_names’ and ‘race_names’ to ensure consistency in how we reference these categories throughout our analysis. This is a form of data standardization, where we ensure that all data manipulation and analysis refer to the same set of standardized category names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>state_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Alabama"</span>, <span class="st">"Alaska"</span>, <span class="st">"Arizona"</span>, <span class="st">"Arkansas"</span>, <span class="st">"California"</span>, <span class="st">"Colorado"</span>, <span class="st">"Connecticut"</span>, <span class="st">"Delaware"</span>, <span class="st">"Florida"</span>, <span class="st">"Georgia"</span>, <span class="st">"Hawaii"</span>, <span class="st">"Idaho"</span>, <span class="st">"Illinois"</span>, <span class="st">"Indiana"</span>, <span class="st">"Iowa"</span>, <span class="st">"Kansas"</span>, <span class="st">"Kentucky"</span>, <span class="st">"Louisiana"</span>, <span class="st">"Maine"</span>, <span class="st">"Maryland"</span>, <span class="st">"Massachusetts"</span>, <span class="st">"Michigan"</span>, <span class="st">"Minnesota"</span>, <span class="st">"Mississippi"</span>, <span class="st">"Missouri"</span>, <span class="st">"Montana"</span>, <span class="st">"Nebraska"</span>, <span class="st">"Nevada"</span>, <span class="st">"New Hampshire"</span>, <span class="st">"New Jersey"</span>, <span class="st">"New Mexico"</span>, <span class="st">"New York"</span>, <span class="st">"North Carolina"</span>, <span class="st">"North Dakota"</span>, <span class="st">"Ohio"</span>, <span class="st">"Oklahoma"</span>, <span class="st">"Oregon"</span>, <span class="st">"Pennsylvania"</span>, <span class="st">"Rhode Island"</span>, <span class="st">"South Carolina"</span>, <span class="st">"South Dakota"</span>, <span class="st">"Tennessee"</span>, <span class="st">"Texas"</span>, <span class="st">"Utah"</span>, <span class="st">"Vermont"</span>, <span class="st">"Virginia"</span>, <span class="st">"Washington"</span>, <span class="st">"West Virginia"</span>, <span class="st">"Wisconsin"</span>, <span class="st">"Wyoming"</span>, <span class="st">"Puerto Rico"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>race_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"White Alone"</span>, <span class="st">"White alone, not Hispanic or Latino"</span>, <span class="st">"Black Alone"</span>, <span class="st">"American Indian or Alaska Native Alone"</span>, <span class="st">"Asian Alone"</span>, <span class="st">"Native Hawaiian and Other Pacific Islander Alone"</span>, <span class="st">"Some other race Alone"</span>, <span class="st">"Two or more races"</span>, <span class="st">"Hispanic or Latino Origin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>3. Creating 2 functions to pull data from the ACS</em></p>
<p>The <em>first function</em> uses a for loop to loop through each races in ‘race_names’ for each of the races used a nested ‘for loop’ to go through each of the states in ‘state_names’. In the nested for loop, we identify which columns we need to pull from for the gendered percentage attainment of bachelor degrees and transfer these columns into new data tibbles (organized by state). We then combine these tables to put it into one table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>gendered_raced_data <span class="ot">&lt;-</span> <span class="cf">function</span>(race_names, state_names, data) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  race_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (race <span class="cf">in</span> race_names) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    state_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">51</span>) {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      state <span class="ot">=</span> state_names[index]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>      multiplier <span class="ot">&lt;-</span> <span class="fu">which</span>(race_names <span class="sc">==</span> race) </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>      string2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"*"</span>, multiplier)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      label <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Bachelor's degree or higher"</span>, <span class="fu">paste</span>(string2, <span class="at">collapse =</span> <span class="st">""</span>), </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      filtered_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(acs_data, Label <span class="sc">==</span> label)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>      number_m_bach <span class="ot">&lt;-</span> <span class="dv">9</span> <span class="sc">+</span> <span class="dv">12</span> <span class="sc">*</span> (index <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>      number_f_bach <span class="ot">&lt;-</span> <span class="dv">13</span> <span class="sc">+</span> <span class="dv">12</span> <span class="sc">*</span> (index <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>      state_data[[state]] <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> state,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">Years =</span> filtered_data<span class="sc">$</span>Years,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">Male_P_Bach =</span> filtered_data[[<span class="fu">paste0</span>(<span class="st">"..."</span>, number_m_bach)]],</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">Female_P_Bach =</span> filtered_data[[<span class="fu">paste0</span>(<span class="st">"..."</span>, number_f_bach)]],</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">Race =</span> race</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    combined_state <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(state_data)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    race_data[[race]] <span class="ot">&lt;-</span> combined_state</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  race_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(race_data)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(race_data)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <em>second function</em> works similarly to the first, except we do not have the outer for loop for the different races as the median income data is not categorized by race. We still loop through the different states and pull the columns containing the median incomes for people with bachelor degrees and people with graduate (or higher) degrees.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Median_Income_Data <span class="ot">&lt;-</span> <span class="cf">function</span> (state_names, data) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  state_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">51</span>) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    state <span class="ot">=</span> state_names[index]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    bach_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(acs_data, Label <span class="sc">==</span> <span class="st">"Bachelor's degree"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    grad_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(acs_data, Label <span class="sc">==</span> <span class="st">"Graduate or professional degree"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    male <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="sc">+</span> <span class="dv">12</span> <span class="sc">*</span> (index <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    female <span class="ot">&lt;-</span> <span class="dv">11</span> <span class="sc">+</span> <span class="dv">12</span> <span class="sc">*</span> (index <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    both <span class="ot">&lt;-</span> state</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    state_data[[state]] <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">State =</span> state,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">Years =</span> bach_data<span class="sc">$</span>Years,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">Median_Bach =</span> bach_data[[both]],</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">Bach_M_Median =</span> bach_data[[<span class="fu">paste0</span>(<span class="st">"..."</span>, male)]],</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">Bach_F_Median =</span> bach_data[[<span class="fu">paste0</span>(<span class="st">"..."</span>, female)]],</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">Median_Grad =</span> grad_data[[both]],</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">Grad_M_Median =</span> grad_data[[<span class="fu">paste0</span>(<span class="st">"..."</span>, male)]],</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">Grad_F_Median =</span> grad_data[[<span class="fu">paste0</span>(<span class="st">"..."</span>, female)]]</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  combined_state <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(state_data)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  combined_state <span class="ot">&lt;-</span> combined_state <span class="sc">%&gt;%</span> </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Years <span class="sc">&gt;</span> <span class="dv">2014</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined_state)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">Median_Income_Data</span>(state_names, acs_data)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(data2, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">'dataset'</span>, <span class="st">'ACS_Median_Income.csv'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>4. Calling the functions and writing new CSV’s</em></p>
<p>We call the functions to write 2 new dataframes. Then we write the data frames into new CSV’s to make it easily accessible without having to rerun the script.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">gendered_raced_data</span>(race_names, state_names, acs_data)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(data, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">'dataset'</span>, <span class="st">'ACS_Gender_and_Race.csv'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The cleaning script for dataset 1 can be found below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">source</span>(<span class="st">"scripts/acs_bach.R"</span>)) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>script_content <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"scripts/acs_bach.R"</span>) </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(script_content, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
# Reading Data and Initializing Packages
suppressMessages(library(readxl))
suppressMessages(library(tidyverse))

acs_data &lt;- read.csv('dataset/ACS_data_rendered.csv')

state_names &lt;- c("Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado", "Connecticut", "Delaware", "Florida", "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas", "Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota", "Mississippi", "Missouri", "Montana", "Nebraska", "Nevada", "New Hampshire", "New Jersey", "New Mexico", "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon", "Pennsylvania", "Rhode Island", "South Carolina", "South Dakota", "Tennessee", "Texas", "Utah", "Vermont", "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming", "Puerto Rico")

race_names &lt;- c("White Alone", "White alone, not Hispanic or Latino", "Black Alone", "American Indian or Alaska Native Alone", "Asian Alone", "Native Hawaiian and Other Pacific Islander Alone", "Some other race Alone", "Two or more races", "Hispanic or Latino Origin")

# function to extract Bachelor Attainment Percentage
gendered_raced_data &lt;- function(race_names, state_names, data) {
  race_data &lt;- list()
  for (race in race_names) {
    state_data &lt;- list()
    for (index in 1:51) {
      state = state_names[index]
      multiplier &lt;- which(race_names == race) 
      string2 &lt;- rep("*", multiplier)
      label &lt;- paste("Bachelor's degree or higher", paste(string2, collapse = ""), 
                     sep = "")
      filtered_data &lt;- filter(acs_data, Label == label)
      number_m_bach &lt;- 9 + 12 * (index - 1)
      number_f_bach &lt;- 13 + 12 * (index - 1)
      state_data[[state]] &lt;- tibble(
        State = state,
        Years = filtered_data$Years,
        Male_P_Bach = filtered_data[[paste0("...", number_m_bach)]],
        Female_P_Bach = filtered_data[[paste0("...", number_f_bach)]],
        Race = race
      )
    }
    combined_state &lt;- bind_rows(state_data)
    race_data[[race]] &lt;- combined_state
  }
  # if you want separate tables for each race, comment out this line of data
  race_data &lt;- bind_rows(race_data)
  
  return(race_data)
}

Median_Income_Data &lt;- function (state_names, data) {
  state_data &lt;- list()
  for (index in 1:51) {
    state = state_names[index]
    bach_data &lt;- filter(acs_data, Label == "Bachelor's degree")
    grad_data &lt;- filter(acs_data, Label == "Graduate or professional degree")
    male &lt;- 7 + 12 * (index - 1)
    female &lt;- 11 + 12 * (index - 1)
    both &lt;- state
    state_data[[state]] &lt;- tibble(
      State = state,
      Years = bach_data$Years,
      Median_Bach = bach_data[[both]],
      Bach_M_Median = bach_data[[paste0("...", male)]],
      Bach_F_Median = bach_data[[paste0("...", female)]],
      Median_Grad = grad_data[[both]],
      Grad_M_Median = grad_data[[paste0("...", male)]],
      Grad_F_Median = grad_data[[paste0("...", female)]]
    ) 
    
  }
  combined_state &lt;- bind_rows(state_data)
  combined_state &lt;- combined_state %&gt;% 
    filter(Years &gt; 2014)
  
  return(combined_state)
}

Median_Income_Data_Perc &lt;- function (state_names, data) {
  state_data &lt;- list()
  for (index in 1:51) {
    state = state_names[index]
    bach_data &lt;- filter(acs_data, Label == "Bachelor's degree")
    grad_data &lt;- filter(acs_data, Label == "Graduate or professional degree")
    male &lt;- 9 + 12 * (index - 1)
    female &lt;- 13 + 12 * (index - 1)
    both &lt;- state
    state_data[[state]] &lt;- tibble(
      State = state,
      Years = bach_data$Years,
      Median_Bach = bach_data[[both]],
      Bach_M_Median = bach_data[[paste0("...", male)]],
      Bach_F_Median = bach_data[[paste0("...", female)]],
      Median_Grad = grad_data[[both]],
      Grad_M_Median = grad_data[[paste0("...", male)]],
      Grad_F_Median = grad_data[[paste0("...", female)]]
    ) 
    
  }
  combined_state &lt;- bind_rows(state_data)
  combined_state &lt;- combined_state %&gt;% 
    filter(Years &gt; 2014)
  
  return(combined_state)
}

data2 &lt;- Median_Income_Data(state_names, acs_data)
write_csv(data2, here::here('dataset', 'ACS_Median_Income.csv'))

data3 &lt;- Median_Income_Data_Perc(state_names, acs_data)
write.csv(data3, here::here('dataset', 'ACS_Median_Income_Perc.csv'))

# Save Data
data &lt;- gendered_raced_data(race_names, state_names, acs_data)
write_csv(data, here::here('dataset', 'ACS_Gender_and_Race.csv'))</code></pre>
</div>
</div>
<p><strong>Data set 2: U.S. Department of Labor <em>(DOL)</em> Data - Median Annual Earnings</strong></p>
<p>Our <em>secondary dataset</em> is from the U.S. Department of Labor <em>(DOL)</em>, specifically through the Bureau of Labor Statistics (BLS). The data set is named “Median annual earnings by sex, race, and Hispanic ethnicity”, providing data from 1960 - 2022 regarding the median average earnings of males and females, faceted to races and states. The U.S. Bureau of Labor Statistics collects, analyzes, and publishes reliable information on socioeconomic status. The link to this DOL dataset is <a href="https://bit.ly/3JAw0qz" class="uri">https://bit.ly/3JAw0qz</a>.</p>
<p>The data from the DOL, specifically the median annual earnings by sex, race, and Hispanic ethnicity, are collected to track economic trends and labor market conditions. This information is critical for formulating labor policies, understanding income disparities, and enforcing laws around wages and employment equity</p>
<p>The dependent variable in this data is median annual earnings in 2021 CPI-U-RS adjusted dollars. The independent variable is the years from 1960 to 2023. And, the data is filled with the following gender and race groups: White women, White men, Black women, Black men, Asian women, Asian men, Hispanic women, Hispanic men, White non-Hispanic Women, White non-Hispanic Men.</p>
<p>The data cleaning process for dataset 2 is below:</p>
<p><em>1. Initial Data Reading and Package Loading</em></p>
<p>We loaded the data using ‘read_csv’ from the ‘readr’ package. This function is efficient for handling large datasets and allows easier manipulation of our dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>income_data <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"dataset/Income_dofl.csv"</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>2. Filtering Data Based on Specific Criteria</em></p>
<p>We filtered out records from 2013 and 2017 unless they were part of a new methodology implementation. In this way, we can ensure consistency in how data across different years were collected and reported.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>income_data_clean <span class="ot">&lt;-</span> income_data<span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">!=</span> <span class="dv">2013</span> <span class="sc">|</span> <span class="st">`</span><span class="at">In / Out of New Methodology Implemented</span><span class="st">`</span> <span class="sc">==</span> <span class="st">'In'</span>)<span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">!=</span> <span class="dv">2017</span> <span class="sc">|</span> <span class="st">`</span><span class="at">In / Out of New Methodology Implemented</span><span class="st">`</span> <span class="sc">==</span> <span class="st">'In'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>3. Selecting and Pivoting Data for Analysis</em></p>
<p>We transformed the dataset from a long to a wide format using ‘pivot_wider’, making it easier to analyze income measures across different years. Columns were arranged by year to maintain a chronological order.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>income_data_clean <span class="ot">&lt;-</span> income_data_clean <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Measure Names</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">`</span><span class="at">Measure Names</span><span class="st">`</span>, <span class="at">values_from =</span> <span class="st">`</span><span class="at">Measure Values</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>4. Saving Cleaned Data</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(income_data_clean, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">'dataset'</span>, <span class="st">'dofl_income_clean.csv'</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(income_data_clean, <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">'dataset/dofl_income_clean.RData'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The cleaning script for dataset 2 can be found below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">source</span>(<span class="st">"scripts/Income_data_cleaning.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 780 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): In / Out of New Methodology Implemented, In / Out of New Processing...
dbl (1): Year
num (1): Measure Values

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>script_content <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"scripts/Income_data_cleaning.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines("scripts/Income_data_cleaning.R"): incomplete final line
found on 'scripts/Income_data_cleaning.R'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(script_content, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>income_data = read_csv("dataset/Income_dofl.csv")
### median income data split by race

income_data_clean &lt;- income_data|&gt;
  filter(Year != 2013 | `In / Out of New Methodology Implemented` == 'In')|&gt;
  filter(Year != 2017 | `In / Out of New Methodology Implemented` == 'In')|&gt;
  select(-c(1,2)) |&gt;
  group_by(`Measure Names`) |&gt;
  pivot_wider(names_from = `Measure Names`, values_from = `Measure Values`) |&gt; 
  arrange(Year)

write_csv(income_data_clean, file = here::here('dataset', 'dofl_income_clean.csv'))
saveRDS(income_data_clean, file = here::here('dataset/dofl_income_clean.RData'))</code></pre>
</div>
</div>
<p><strong>Data set 3: American Community Survey <em>(ACS)</em> - Poverty Status</strong></p>
<p>Another dataset we used is from the American Community Survey <em>(ACS)</em>, which provides data from 2015 - 2020 regarding poverty status of males, and females, faceted to race and state. We selected this dataset because we wanted to analyze gender disparities, particularly seeing the proportion of males above poverty line compared to females, by race and state.</p>
<p>The dataset is accessed via the ‘tidycensus’ package in R because the ‘tidycensus’ package simplifies the process of working with Census data, allowing for efficient data retrieval and handling. To load the variables for the year 2020, we use the function ‘load_variables(2020, “acs5”, cache = TRUE)’. This function fetches a list of available variables from the 5-year ACS dataset for 2020, caching them to speed up future queries.</p>
<p>The dependent variable in this dataset is the poverty status, which is defined as the proportion of individuals below the poverty line in each surveyed group. The independent variables include the year of the survey, which ranges from 2015-2020, and demographic identifiers such as race and state.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>