{
  "hash": "33a33b0ff050b5bf9f467e602af62cd8",
  "result": {
    "markdown": "### starting to consider what figures to create\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyverse' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tibble' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyr' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'readr' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'purrr' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'dplyr' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'forcats' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'lubridate' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nEmp_wb = read_csv('dataset/World_Bank_Employment_Data.csv', show_col_types = F)\nEduc_wb = read_csv('dataset/World_Bank_Educ_Data.csv', show_col_types = F)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nEmp_wb$Year <- as.Date(as.character(Emp_wb$Year), format = \"%Y\") \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(tidyverse))\nsuppressPackageStartupMessages(library(tidycensus))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidycensus' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nsuppressPackageStartupMessages(library(sf))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'sf' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nv2020 <- load_variables(2020, \"acs5\", cache = TRUE)\n\nconcepts <- v2020 |>\n  filter(str_detect(concept, '^MEDIAN INCOME'))\n\n### Would like to analyze B19326_004 and B19326_005 (They were a dud, most likely skewed due to part-time workers)\n\n### poverty data from ACS\npoverty_test <- get_acs(\n  geography = 'state',\n  variables = 'B17001A_001',\n  year = 2020,\n  geometry = TRUE\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nGetting data from the 2016-2020 5-year ACS\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nDownloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |===================================================                   |  74%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |======================================================================| 100%\n```\n:::\n\n```{.r .cell-code}\n### Looking at C24040_002 and C24040_029 now which are\n##SEX BY INDUSTRY FOR THE FULL-TIME, YEAR-ROUND CIVILIAN EMPLOYED POPULATION 16 YEARS AND OVER for male and female\n\n\nvars_df <- v2020 |>\n  filter(name == 'C24040_002' | name == 'C24040_029') |>\n  mutate(\n    variable = name,\n    gender = if_else(\n      str_detect(label, 'Male'),\n      'Male',\n      'Female'\n    ),\n    .keep = 'none'\n  )\n\ngendered_employment <- get_acs(\n  geography = 'state',\n  variables = vars_df |> pull(variable),\n  year = 2020,\n  geometry = TRUE\n) |> \n  left_join(vars_df) |>\n  select(-moe, -variable, -GEOID) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nGetting data from the 2016-2020 5-year ACS\nDownloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(variable)`\n```\n:::\n\n```{.r .cell-code}\n### name is state data\n\ngendered_employment_split <- gendered_employment |>\n  pivot_wider(names_from = 'gender', values_from = 'estimate')\n  \n\ntotal_employment <- gendered_employment |>\n  group_by(geometry) |>\n  summarise(total = sum(estimate))\n\ngendered_employment_final <- st_join(gendered_employment, total_employment, join = st_equals)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngendered_employment_split |>\n  ggplot(aes(fill =  `Male`/`Female`)) + \n  geom_sf() +\n  coord_sf(crs = 5070) +\n  scale_fill_viridis_c(option = 'plasma')+\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/heatmap idea for median working population-1.png){width=672}\n:::\n\n```{.r .cell-code}\n### this creates two maps, which are representative of the proportion of full time, year round civilians in each state faceted by gender. I'm not sure if this is the best approach to data presentation, and I am open to other ideas\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nincome_data = read_csv(\"dataset/Income_dofl.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 780 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): In / Out of New Methodology Implemented, In / Out of New Processing...\ndbl (1): Year\nnum (1): Measure Values\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n### median income data split by race\n\nincome_data_clean <- income_data|>\n  filter(Year != 2013 | `In / Out of New Methodology Implemented` == 'In')|>\n  filter(Year != 2017 | `In / Out of New Methodology Implemented` == 'In')|>\n  select(-c(1,2)) |>\n  group_by(`Measure Names`) |>\n  pivot_wider(names_from = `Measure Names`, values_from = `Measure Values`) |> arrange(desc(Year))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndesired_vars = c('B17001A_032','B17001A_003','B17001A_017', 'B17001A_046','B17001B_003','B17001B_017','B17001B_032','B17001B_046','B17001C_003','B17001C_017','B17001C_032','B17001C_046','B17001D_003','B17001D_017','B17001D_032','B17001D_046','B17001E_003','B17001E_017','B17001E_032','B17001E_046','B17001F_003','B17001F_017','B17001F_032','B17001F_046','B17001G_003','B17001G_017','B17001G_032','B17001G_046','B17001H_003','B17001H_017','B17001H_032','B17001H_046','B17001I_003','B17001I_017','B17001I_032','B17001I_046')\n\nv2020 <- load_variables(2020, \"acs5\", cache = TRUE)\n\npoverty_data <- v2020 |>\n  filter(name %in% desired_vars) |>\n  mutate(\n    variable = name,\n    gender = if_else(\n      str_detect(label, 'Male'),\n      'Male',\n      'Female'\n      ),\n   race = str_extract(concept, \"\\\\((.*?)\\\\)\"),\n   status = if_else(str_detect(label, 'above'),\n                    'Above Poverty Line',\n                    'Below Poverty Line'\n                    ),\n\n    .keep= 'none'\n  )\n\npoverty_data$race <- gsub(\"[\\\\(\\\\)]\", \"\", trimws(poverty_data$race))\npoverty_data$race <- str_to_title(poverty_data$race)\n\npoverty_final <- get_acs(\n  geography = 'state',\n  variables = poverty_data |> pull(variable),\n  year = 2020,\n  geometry = TRUE\n) |> \n  left_join(poverty_data) |>\n  select(-moe, -variable, -GEOID) |>\n  group_by(race, gender, NAME) |>\n  mutate(\n    gendered_total = sum(estimate[status == 'Above Poverty Line'], estimate[status == 'Below Poverty Line']),\n    proportion = (estimate[status == 'Above Poverty Line']/gendered_total)\n  ) |>\n  filter(status != 'Below Poverty Line') |>\n  ungroup() |>\n  select(-estimate, -NAME, -status, -gendered_total) |>\n  pivot_wider(names_from = c(gender,race), values_from = proportion, names_sep = ' ')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nGetting data from the 2016-2020 5-year ACS\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nDownloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(variable)`\n```\n:::\n\n```{.r .cell-code}\ncolumn_names <- names(poverty_final)[-which(names(poverty_final) == \"geometry\")]\n\nfor (x in column_names) {\n  print(\n    ggplot(data = poverty_final, aes(fill = .data[[x]])) +\n      geom_sf() +\n      coord_sf(crs = 5070) +\n      scale_fill_viridis_c(option = 'plasma', limits = c(.3,1)) +\n      theme_minimal() +\n      theme(legend.title = element_blank()) +\n      labs(title = x)\n  )\n}\n```\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-6.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-7.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-10.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-11.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-12.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-13.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-14.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-15.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-16.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-17.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](figure_analysis_files/figure-html/Alternate concept-18.png){width=672}\n:::\n:::\n",
    "supporting": [
      "figure_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}